import{s as Ie,r as Oe,a as ye,c as Be,o as Le}from"../chunks/scheduler.DXwQMlsl.js";import{S as Me,i as Ue,d as u,m as Fe,n as Ve,o as je,p as ke,s as Z,a as A,b as _,q as Ge,r as ie,k as L,c as E,l as Ne,g as F,e as C,f as k,v as He,h as N,j as V,t as S,w as Je,A as Re,B as Se,x as ze,u as Ae}from"../chunks/index.BwbdioCG.js";import{e as we}from"../chunks/each.D6YF6ztN.js";import{f as Ke,a as Qe}from"../chunks/format.j6oJxotq.js";import{t as We}from"../chunks/period.ClbncGIq.js";import{T as Xe}from"../chunks/Table.BaPFpwIW.js";import{p as Ye}from"../chunks/stores.CiKr0iYP.js";function Te(o,a,l){const s=o.slice();return s[14]=a[l],s}function Ce(o){let a,l;return{c(){a=N("p"),l=S(o[2]),this.h()},l(s){a=E(s,"P",{class:!0});var e=C(a);l=k(e,o[2]),e.forEach(u),this.h()},h(){L(a,"class","danger")},m(s,e){A(s,a,e),_(a,l)},p(s,e){e&4&&Z(l,s[2])},d(s){s&&u(a)}}}function De(o){let a,l=we(o[1].accounts_for_select),s=[];for(let e=0;e<l.length;e+=1)s[e]=qe(Te(o,l,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();a=Se()},l(e){for(let i=0;i<s.length;i+=1)s[i].l(e);a=Se()},m(e,i){for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(e,i);A(e,a,i)},p(e,i){if(i&2){l=we(e[1].accounts_for_select);let n;for(n=0;n<l.length;n+=1){const d=Te(e,l,n);s[n]?s[n].p(d,i):(s[n]=qe(d),s[n].c(),s[n].m(a.parentNode,a))}for(;n<s.length;n+=1)s[n].d(1);s.length=l.length}},d(e){e&&u(a),Re(s,e)}}}function qe(o){let a,l=(o[14].path||o[14].name)+"",s,e;return{c(){a=N("option"),s=S(l),this.h()},l(i){a=E(i,"OPTION",{});var n=C(a);s=k(n,l),n.forEach(u),this.h()},h(){a.__value=e=o[14].id,Ae(a,a.__value)},m(i,n){A(i,a,n),_(a,s)},p(i,n){n&2&&l!==(l=(i[14].path||i[14].name)+"")&&Z(s,l),n&2&&e!==(e=i[14].id)&&(a.__value=e,Ae(a,a.__value))},d(i){i&&u(a)}}}function Ze(o){var ue,_e,fe,pe,me,he,de;let a,l="Journal Entries",s,e,i="Account-level drilldown.",n,d,g,T,j,P,R,b,z,G=(((_e=(ue=o[1])==null?void 0:ue.pagination)==null?void 0:_e.total)??0)+"",J,r,f,v,D,p,w,K,x,ae,q,se,Q=(((pe=(fe=o[1])==null?void 0:fe.pagination)==null?void 0:pe.page)??1)+"",$,le,W=(((he=(me=o[1])==null?void 0:me.pagination)==null?void 0:he.pages)??1)+"",ee,ne,I,oe,te,O,re,ce,m=o[2]&&Ce(o),h=((de=o[1])==null?void 0:de.accounts_for_select)&&De(o);return v=new Xe({props:{columns:o[3],rows:o[1]?o[1].entries:[]}}),{c(){a=N("h1"),a.textContent=l,s=V(),e=N("p"),e.textContent=i,n=V(),m&&m.c(),d=V(),g=N("div"),T=N("label"),j=S(`Account: \r
    `),P=N("select"),h&&h.c(),R=V(),b=N("span"),z=S("Total: "),J=S(G),r=S(" entries"),f=V(),Je(v.$$.fragment),D=V(),p=N("div"),w=N("button"),K=S("Prev Page"),ae=V(),q=N("span"),se=S("Page "),$=S(Q),le=S(" / "),ee=S(W),ne=V(),I=N("button"),oe=S("Next Page"),this.h()},l(t){a=E(t,"H1",{class:!0,"data-svelte-h":!0}),Ne(a)!=="svelte-vinmls"&&(a.textContent=l),s=F(t),e=E(t,"P",{class:!0,"data-svelte-h":!0}),Ne(e)!=="svelte-3hiry4"&&(e.textContent=i),n=F(t),m&&m.l(t),d=F(t),g=E(t,"DIV",{class:!0});var c=C(g);T=E(c,"LABEL",{});var y=C(T);j=k(y,`Account: \r
    `),P=E(y,"SELECT",{});var M=C(P);h&&h.l(M),M.forEach(u),y.forEach(u),R=F(c),b=E(c,"SPAN",{class:!0});var H=C(b);z=k(H,"Total: "),J=k(H,G),r=k(H," entries"),H.forEach(u),c.forEach(u),f=F(t),He(v.$$.fragment,t),D=F(t),p=E(t,"DIV",{class:!0});var B=C(p);w=E(B,"BUTTON",{class:!0});var X=C(w);K=k(X,"Prev Page"),X.forEach(u),ae=F(B),q=E(B,"SPAN",{class:!0});var U=C(q);se=k(U,"Page "),$=k(U,Q),le=k(U," / "),ee=k(U,W),U.forEach(u),ne=F(B),I=E(B,"BUTTON",{class:!0});var Y=C(I);oe=k(Y,"Next Page"),Y.forEach(u),B.forEach(u),this.h()},h(){var t,c,y,M;L(a,"class","page-title"),L(e,"class","page-subtitle"),o[0]===void 0&&ye(()=>o[9].call(P)),L(b,"class","meta"),L(g,"class","toolbar"),L(w,"class","button"),w.disabled=x=!((c=(t=o[1])==null?void 0:t.pagination)!=null&&c.has_prev),L(q,"class","meta"),L(I,"class","button"),I.disabled=te=!((M=(y=o[1])==null?void 0:y.pagination)!=null&&M.has_next),L(p,"class","toolbar")},m(t,c){A(t,a,c),A(t,s,c),A(t,e,c),A(t,n,c),m&&m.m(t,c),A(t,d,c),A(t,g,c),_(g,T),_(T,j),_(T,P),h&&h.m(P,null),ke(P,o[0],!0),_(g,R),_(g,b),_(b,z),_(b,J),_(b,r),A(t,f,c),Ge(v,t,c),A(t,D,c),A(t,p,c),_(p,w),_(w,K),_(p,ae),_(p,q),_(q,se),_(q,$),_(q,le),_(q,ee),_(p,ne),_(p,I),_(I,oe),O=!0,re||(ce=[ie(P,"change",o[9]),ie(w,"click",o[10]),ie(I,"click",o[11])],re=!0)},p(t,[c]){var M,H,B,X,U,Y,ge,be,ve,Pe,Ee;t[2]?m?m.p(t,c):(m=Ce(t),m.c(),m.m(d.parentNode,d)):m&&(m.d(1),m=null),(M=t[1])!=null&&M.accounts_for_select?h?h.p(t,c):(h=De(t),h.c(),h.m(P,null)):h&&(h.d(1),h=null),c&3&&ke(P,t[0]),(!O||c&2)&&G!==(G=(((B=(H=t[1])==null?void 0:H.pagination)==null?void 0:B.total)??0)+"")&&Z(J,G);const y={};c&2&&(y.rows=t[1]?t[1].entries:[]),v.$set(y),(!O||c&2&&x!==(x=!((U=(X=t[1])==null?void 0:X.pagination)!=null&&U.has_prev)))&&(w.disabled=x),(!O||c&2)&&Q!==(Q=(((ge=(Y=t[1])==null?void 0:Y.pagination)==null?void 0:ge.page)??1)+"")&&Z($,Q),(!O||c&2)&&W!==(W=(((ve=(be=t[1])==null?void 0:be.pagination)==null?void 0:ve.pages)??1)+"")&&Z(ee,W),(!O||c&2&&te!==(te=!((Ee=(Pe=t[1])==null?void 0:Pe.pagination)!=null&&Ee.has_next)))&&(I.disabled=te)},i(t){O||(je(v.$$.fragment,t),O=!0)},o(t){Ve(v.$$.fragment,t),O=!1},d(t){t&&(u(a),u(s),u(e),u(n),u(d),u(g),u(f),u(D),u(p)),m&&m.d(t),h&&h.d(),Fe(v,t),re=!1,Oe(ce)}}}function xe(o,a,l){let s;Be(o,Ye,r=>l(12,s=r));let e=null,i="",n="all",d="",g="",T="",j=!1;const P=[{header:"Date",render:r=>r.entry_date},{header:"Debit Account",render:r=>r.debit_account},{header:"Amount",render:r=>Ke(r.amount),align:"right"},{header:"Description",render:r=>r.description},{header:"Credit Account",render:r=>r.credit_account}];function R(r,f,v){if(r==="upto"&&f){l(5,n="custom"),l(6,d="1900-01-01"),l(7,g=f);return}if(r==="month"&&v){const[D,p]=v.split("-"),w=new Date(Number(D),Number(p)-1,1),K=new Date(Number(D),Number(p),0);l(5,n="custom"),l(6,d=w.toISOString().slice(0,10)),l(7,g=K.toISOString().slice(0,10));return}l(5,n="all"),l(6,d=""),l(7,g="")}async function b(r=1){try{l(2,T="");const f=new URLSearchParams;f.set("period",We(n,d,g)),i&&f.set("account_id",i),f.set("page",String(r)),l(1,e=await Qe(`/transactions?${f.toString()}`))}catch(f){l(2,T=f.message||"Failed to load.")}}Le(async()=>{l(8,j=!0);const r=s.url.searchParams,f=r.get("account_id"),v=r.get("mode"),D=r.get("end"),p=r.get("month");f&&l(0,i=f),R(v,D,p),await b(1)});function z(){i=ze(this),l(0,i),l(1,e)}const G=()=>{var r;return b((((r=e==null?void 0:e.pagination)==null?void 0:r.page)||1)-1)},J=()=>{var r;return b((((r=e==null?void 0:e.pagination)==null?void 0:r.page)||1)+1)};return o.$$.update=()=>{o.$$.dirty&481&&j&&b(1)},[i,e,T,P,b,n,d,g,j,z,G,J]}class ot extends Me{constructor(a){super(),Ue(this,a,xe,Ze,Ie,{})}}export{ot as component};
