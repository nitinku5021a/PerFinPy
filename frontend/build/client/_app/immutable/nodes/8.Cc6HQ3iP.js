import{s as R,r as Y,o as J}from"../chunks/scheduler.DXwQMlsl.js";import{S as Q,i as X,d as b,m as x,n as $,o as tt,a as M,b as y,q as et,r as A,k as O,c as E,l as V,g as L,e as F,f as j,v as st,h as P,j as I,t as z,w as nt,s as rt}from"../chunks/index.BwbdioCG.js";import{f as ot,a as lt}from"../chunks/format.j6oJxotq.js";import{N as at}from"../chunks/NetworthMatrixTable.CwFbBUxZ.js";function W(e){let s,n;return{c(){s=P("p"),n=z(e[4]),this.h()},l(i){s=E(i,"P",{class:!0});var l=F(s);n=j(l,e[4]),l.forEach(b),this.h()},h(){O(s,"class","danger")},m(i,l){M(i,s,l),y(s,n)},p(i,l){l&16&&rt(n,i[4])},d(i){i&&b(s)}}}function it(e){let s,n="Net Worth",i,l,f="Last 12 months across asset and liability groups.",_,g,c,S,k,p,T,d,q,B,U,w,m,r,u,h,N,C,D,a=e[4]&&W(e);return h=new at({props:{groups:e[7],months:e[1],formatValue:ot,drillMode:"upto",networthLabel:"NETWORTH",networthByMonth:e[13]()}}),{c(){s=P("h1"),s.textContent=n,i=I(),l=P("p"),l.textContent=f,_=I(),a&&a.c(),g=I(),c=P("div"),S=P("label"),k=P("input"),p=z(`\r
     Show zero balances (latest month)`),T=I(),d=P("button"),q=z("Prev 12"),U=I(),w=P("button"),m=z("Next 12"),u=I(),nt(h.$$.fragment),this.h()},l(t){s=E(t,"H1",{class:!0,"data-svelte-h":!0}),V(s)!=="svelte-vgf76k"&&(s.textContent=n),i=L(t),l=E(t,"P",{class:!0,"data-svelte-h":!0}),V(l)!=="svelte-1m62oqs"&&(l.textContent=f),_=L(t),a&&a.l(t),g=L(t),c=E(t,"DIV",{class:!0});var o=F(c);S=E(o,"LABEL",{});var v=F(S);k=E(v,"INPUT",{type:!0}),p=j(v,`\r
     Show zero balances (latest month)`),v.forEach(b),T=L(o),d=E(o,"BUTTON",{class:!0});var G=F(d);q=j(G,"Prev 12"),G.forEach(b),U=L(o),w=E(o,"BUTTON",{class:!0});var H=F(w);m=j(H,"Next 12"),H.forEach(b),o.forEach(b),u=L(t),st(h.$$.fragment,t),this.h()},h(){O(s,"class","page-title"),O(l,"class","page-subtitle"),O(k,"type","checkbox"),O(d,"class","button"),d.disabled=B=!e[5],O(w,"class","button"),w.disabled=r=!e[6],O(c,"class","toolbar")},m(t,o){M(t,s,o),M(t,i,o),M(t,l,o),M(t,_,o),a&&a.m(t,o),M(t,g,o),M(t,c,o),y(c,S),y(S,k),k.checked=e[2],y(S,p),y(c,T),y(c,d),y(d,q),y(c,U),y(c,w),y(w,m),M(t,u,o),et(h,t,o),N=!0,C||(D=[A(k,"change",e[10]),A(d,"click",e[11]),A(w,"click",e[12])],C=!0)},p(t,[o]){t[4]?a?a.p(t,o):(a=W(t),a.c(),a.m(g.parentNode,g)):a&&(a.d(1),a=null),o&4&&(k.checked=t[2]),(!N||o&32&&B!==(B=!t[5]))&&(d.disabled=B),(!N||o&64&&r!==(r=!t[6]))&&(w.disabled=r);const v={};o&128&&(v.groups=t[7]),o&2&&(v.months=t[1]),o&3&&(v.networthByMonth=t[13]()),h.$set(v)},i(t){N||(tt(h.$$.fragment,t),N=!0)},o(t){$(h.$$.fragment,t),N=!1},d(t){t&&(b(s),b(i),b(l),b(_),b(g),b(c),b(u)),a&&a.d(t),x(h,t),C=!1,Y(D)}}}function ut(e){const[s,n]=e.split("-");return new Date(Number(s),Number(n)-1,1).toLocaleString("en-US",{month:"short",year:"numeric"})}function Z(e,s){const[n,i]=e.split("-"),l=new Date(Number(n),Number(i)-1+s,1),f=String(l.getMonth()+1).padStart(2,"0");return`${l.getFullYear()}-${f}`}function K(e){const s=Number(e)||0;return Math.round(s)!==0}function ct(e,s,n){let i,l,f=[],_=[],g="",c=!1,S=!1,k=!1,p="",T=!1;async function d(){try{n(4,g="");const m=p?`?start=${p}`:"",r=await lt(`/reports/networth-matrix${m}`);n(0,f=(r==null?void 0:r.groups)||[]),n(1,_=((r==null?void 0:r.months)||[]).map(u=>({key:u,label:ut(u)}))),n(5,S=!!(r!=null&&r.has_older)),n(6,k=!!(r!=null&&r.has_newer)),n(3,p=(r==null?void 0:r.start_month)||p)}catch(m){n(4,g=m.message||"Failed to load.")}}J(async()=>{n(8,T=!0),await d()});function q(){c=this.checked,n(2,c)}const B=()=>n(3,p=Z(p||new Date().toISOString().slice(0,7),-12)),U=()=>n(3,p=Z(p||new Date().toISOString().slice(0,7),12)),w=()=>{const m=f==null?void 0:f.find(u=>u.group==="Assets"),r=f==null?void 0:f.find(u=>u.group==="Liabilities");return!m||!r?null:Object.fromEntries(_.map(u=>{var h,N;return[u.key,(((h=m.monthly_balances)==null?void 0:h[u.key])||0)+(((N=r.monthly_balances)==null?void 0:N[u.key])||0)]}))};return e.$$.update=()=>{e.$$.dirty&264&&T&&d(),e.$$.dirty&2&&n(9,i=_.length?_[0].key:null),e.$$.dirty&519&&n(7,l=c||!i?f:f.map(m=>{const r=(m.parents||[]).map(u=>{const h=(u.accounts||[]).filter(C=>_.some(D=>{var t;const a=((t=C.monthly_balances)==null?void 0:t[D.key])??0;return K(a)}));return _.some(C=>{var a;const D=((a=u.monthly_balances)==null?void 0:a[C.key])??0;return K(D)})||h.length>0?{...u,accounts:h}:null}).filter(Boolean);return{...m,parents:r}}).filter(m=>m.parents&&m.parents.length>0))},[f,_,c,p,g,S,k,l,T,i,q,B,U,w]}class bt extends Q{constructor(s){super(),X(this,s,ct,it,R,{})}}export{bt as component};
